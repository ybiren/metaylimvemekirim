
<div style="display: flex;justify-content: center;padding-bottom: 10px;"><button class="invite-btn" (click)="openReminder('1','aa')">×”×–××Ÿ ×—×‘×¨</button></div>
<div class="top-menu" dir="rtl">
  @if (loggedInUser) {
    <div class="greeting">{{ loggedInUser.c_name }} ×©×œ×•×</div>
  }

  <nav>
    @if (loggedInUser) {
      <a routerLink="/register" routerLinkActive="active">×¢×“×›×•×Ÿ ×¤×¨×˜×™×</a>
      <a routerLink="/search" [queryParams]="randomInit()" routerLinkActive="active">×—×¤×© ×—×‘×¨×™×</a>
      <a routerLink="/users" routerLinkActive="active">×›×œ ×”×—×‘×¨×™×</a>

      <!-- Inbox dropdown -->
      <div class="inbox" [class.open]="open">
        <button
          type="button"
          class="inbox-btn"
          (click)="onInboxBtn($event)"
          aria-label="×¤×ª×™×—×ª ×©×™×—×•×ª"
          [attr.aria-expanded]="open"
          aria-haspopup="dialog"
        >
          <span class="icon">ğŸ’¬</span>
          <span class="label">×©×™×—×•×ª</span>
          <span class="badge" *ngIf="unreadTotal > 0">{{ unreadTotal }}</span>
        </button>

        <!-- Panel: click inside shouldn't close -->
        <div class="panel" *ngIf="open" (click)="$event.stopPropagation()">
          <header class="panel-head">
            <strong>×©×™×—×•×ª</strong>
            <button type="button" class="close" (click)="open = false" aria-label="×¡×’×™×¨×”">âœ•</button>
            <span class="muted" *ngIf="threads.length === 0">××™×Ÿ ×©×™×—×•×ª</span>
          </header>

          <ul class="list">
            <li *ngFor="let t of threads" (click)="openChat(t.peerId)">
              <div class="row">
                <div class="avatar">
                  <span class="dot" [class.online]="isOnline(t.peerId)"></span>
                  <span class="letter">{{ (nameFor(t.peerId) | slice:0:1) }}</span>
                </div>
                <div class="meta">
                  <div class="top">
                    <span class="name">{{ nameFor(t.peerId) }}</span>
                    <span class="time">{{ t.lastAt | date:'shortTime' }}</span>
                  </div>
                  <div class="bottom">
                    <span class="preview">{{ t.lastPreview }}</span>
                    <span class="unread" *ngIf="t.unread > 0">{{ t.unread }}</span>
                  </div>
                </div>
              </div>
            </li>
          </ul>
        </div>
      </div>
    }

    <a (click)="logout()" class="logout">×™×¦×™××”</a>
  </nav>
</div>
