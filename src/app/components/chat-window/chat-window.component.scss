/* =========================================================
   Chat Window (component styles) – RTL / Hebrew optimized
   Multi-user WhatsApp-like sender line
   ========================================================= */

:host {
  --chat-bg:           #e7f0ea;
  --chat-header-bg:    #075e54;
  --chat-header-fg:    #fff;

  --bubble-peer:       #ffffff;
  --bubble-me:         #d7f8d9;

  --bubble-shadow:     0 1px 0 rgba(0,0,0,.06);
  --border-color:      #d9e4de;

  --pad-x: 12px;
  --pad-y: 10px;

  display: block;
  height: 100%;
  min-height: 0; /* critical inside flex parents */
}

/* ===== Layout ===== */
.chat {
  display: flex;
  flex-direction: column;
  height: 100%;
  min-height: 0;
  background: var(--chat-bg);
}

/* ===== Header ===== */
.chat__header {
  position: sticky;
  top: 0;
  z-index: 2;

  display: flex;
  align-items: center;
  gap: 10px;

  padding: var(--pad-y) var(--pad-x);
  color: var(--chat-header-fg);
  background: var(--chat-header-bg);
  box-shadow: var(--bubble-shadow);
}

.chat__close {
  border: 0;
  background: transparent;
  color: inherit;
  font-size: 20px;
  padding: 6px;
  cursor: pointer;
}

.chat__head {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.chat__name {
  font-weight: 700;
}

.chat__status {
  font-size: 12px;
  opacity: .9;
}

.chat__status.online {
  opacity: 1;
}

/* ===== Scroll area (messages) ===== */
.chat__scroll {
  flex: 1 1 auto;
  min-height: 0;
  overflow: auto;

  padding: var(--pad-y) var(--pad-x);
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: contain;

  padding-bottom: calc(var(--pad-y) + env(safe-area-inset-bottom, 0px));
}

/* ===== Empty State ===== */
.chat__empty {
  text-align: center;
  padding: 24px 0;
  color: #5a6b63;
  opacity: .9;
}

/* =========================================================
   Message bubble
   ========================================================= */

.msg {
  display: flex;
  flex-direction: column;     /* sender line on top */
  gap: 4px;

  width: fit-content;
  max-width: 85%;

  margin: 6px 0;
  border-radius: 14px;

  background: var(--bubble-peer);
  box-shadow: var(--bubble-shadow);

  padding-block: 8px;
  padding-inline: 10px 6px;

  direction: rtl;              /* RTL inside bubble */
  white-space: pre-wrap;
  word-break: break-word;
}

/* Outgoing (me) → right side in RTL */
.msg--me {
  background: var(--bubble-me);
  margin-inline-start: auto;   /* push right */
}

/* Incoming (peer) → left side in RTL */
.msg--peer {
  margin-inline-end: auto;     /* push left */
}

/* ===== Sender line (WhatsApp-style) ===== */
.msg__sender {
  font-size: 12px;
  font-weight: 700;
  line-height: 1.1;
  margin-bottom: 2px;

  /* Each sender can have a unique color via CSS var */
  color: var(--sender-color, #1b7f5a);
}

/* ===== Body row: text + meta on the same line ===== */
.msg__body {
  display: flex;
  align-items: flex-end;
  gap: 6px;
}

/* Text */
.msg__text {
  line-height: 1.25;
  text-align: right;
  margin-inline-end: 4px;
}

/* Meta (time + ticks) */
.msg__meta {
  direction: ltr;
  display: inline-flex;
  align-items: center;
  gap: 4px;

  font-size: 11px;
  opacity: .7;
  flex: 0 0 auto;
  white-space: nowrap;
}

.msg__ticks {
  letter-spacing: -1px;
}

.msg__ticks.delivered {
  opacity: .85;
}

.msg__ticks.read {
  opacity: 1;
}

/* ===== Typing indicator ===== */
.chat__typing {
  margin: 8px 0;
  font-size: 12px;
  opacity: .7;
}

/* ===== Composer ===== */
.chat__composer {
  flex: 0 0 auto;

  display: flex;
  align-items: center;
  gap: 8px;

  padding: var(--pad-y) var(--pad-x);
  background: #f2f6f4;
  border-top: 1px solid var(--border-color);
}

.chat__input {
  flex: 1 1 auto;
  min-width: 0;
  min-height: 36px;

  padding: 8px 10px;
  border: 1px solid #c9d6cf;
  border-radius: 999px;
  background: #fff;
  outline: none;
}

.chat__send {
  border: 0;
  border-radius: 999px;
  padding: 8px 14px;

  background: #24a859;
  color: #fff;
  font-weight: 600;
  cursor: pointer;
}

.chat__send:disabled {
  opacity: .5;
  cursor: default;
}

/* ===== Small screens ===== */
@media (max-width: 480px) {
  :host {
    --pad-x: 10px;
    --pad-y: 8px;
  }

  .msg {
    max-width: 90%;
  }
}
